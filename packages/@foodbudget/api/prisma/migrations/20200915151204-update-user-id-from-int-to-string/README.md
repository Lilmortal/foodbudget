# Migration `20200915151204-update-user-id-from-int-to-string`

This migration has been generated by Jack Tan at 9/16/2020, 3:12:05 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."user_allergies" DROP CONSTRAINT "user_allergies_user_id_fkey"

ALTER TABLE "public"."user_diets" DROP CONSTRAINT "user_diets_user_id_fkey"

ALTER TABLE "public"."user_pantries" DROP CONSTRAINT "user_pantries_user_id_fkey"

ALTER TABLE "public"."user_saved_recipes" DROP CONSTRAINT "user_saved_recipes_user_id_fkey"

ALTER TABLE "public"."user_allergies" ALTER COLUMN "user_id" SET DATA TYPE text 

ALTER TABLE "public"."user_diets" ALTER COLUMN "user_id" SET DATA TYPE text 

ALTER TABLE "public"."user_pantries" ALTER COLUMN "user_id" SET DATA TYPE text 

ALTER TABLE "public"."user_saved_recipes" ALTER COLUMN "user_id" SET DATA TYPE text 

ALTER TABLE "public"."users" DROP CONSTRAINT "users_pkey",
ALTER COLUMN "username" SET DATA TYPE text ,
ALTER COLUMN "username" DROP DEFAULT,
ALTER COLUMN "username" DROP DEFAULT,
ADD PRIMARY KEY ("username");
DROP SEQUENCE "users_username_seq"

ALTER TABLE "public"."user_allergies" ADD FOREIGN KEY ("user_id")REFERENCES "public"."users"("username") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."user_diets" ADD FOREIGN KEY ("user_id")REFERENCES "public"."users"("username") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."user_pantries" ADD FOREIGN KEY ("user_id")REFERENCES "public"."users"("username") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."user_saved_recipes" ADD FOREIGN KEY ("user_id")REFERENCES "public"."users"("username") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200915150642-update-id-to-serial..20200915151204-update-user-id-from-int-to-string
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model adjectives {
   adjectives_type   String              @id
@@ -93,40 +93,40 @@
 }
 model user_allergies {
   id           Int        @id @default(autoincrement())
-  user_id      Int?
+  user_id      String?
   allergy_type String?
   allergies    allergies? @relation(fields: [allergy_type], references: [allergy_type])
   users        users?     @relation(fields: [user_id], references: [username])
 }
 model user_diets {
   id        Int     @id @default(autoincrement())
-  user_id   Int?
+  user_id   String?
   diet_type String?
   diets     diets?  @relation(fields: [diet_type], references: [diet_type])
   users     users?  @relation(fields: [user_id], references: [username])
 }
 model user_pantries {
   id              Int          @id @default(autoincrement())
-  user_id         Int?
+  user_id         String?
   ingredient_name String?
   ingredients     ingredients? @relation(fields: [ingredient_name], references: [ingredient_name])
   users           users?       @relation(fields: [user_id], references: [username])
 }
 model user_saved_recipes {
   id        Int      @id @default(autoincrement())
-  user_id   Int?
+  user_id   String?
   recipe_id Int?
   recipes   recipes? @relation(fields: [recipe_id], references: [id])
   users     users?   @relation(fields: [user_id], references: [username])
 }
 model users {
-  username           Int                  @id @default(autoincrement())
+  username           String               @id
   password           String
   nickname           String
   user_allergies     user_allergies[]
   user_diets         user_diets[]
```


