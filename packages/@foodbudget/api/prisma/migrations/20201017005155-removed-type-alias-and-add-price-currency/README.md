# Migration `20201017005155-removed-type-alias-and-add-price-currency`

This migration has been generated by Jack Tan at 10/17/2020, 1:51:55 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."recipe_adjectives" DROP CONSTRAINT "recipe_adjectives_adjectives_type_fkey"

ALTER TABLE "public"."recipe_allergies" DROP CONSTRAINT "recipe_allergies_allergy_type_fkey"

ALTER TABLE "public"."recipe_cuisines" DROP CONSTRAINT "recipe_cuisines_cuisine_type_fkey"

ALTER TABLE "public"."recipe_diets" DROP CONSTRAINT "recipe_diets_diet_type_fkey"

ALTER TABLE "public"."recipe_ingredients" DROP CONSTRAINT "recipe_ingredients_ingredient_name_fkey"

ALTER TABLE "public"."user_allergies" DROP CONSTRAINT "user_allergies_allergy_type_fkey"

ALTER TABLE "public"."user_diets" DROP CONSTRAINT "user_diets_diet_type_fkey"

ALTER TABLE "public"."user_pantries" DROP CONSTRAINT "user_pantries_ingredient_name_fkey"

ALTER TABLE "public"."adjectives" DROP CONSTRAINT "adjectives_pkey",
DROP COLUMN "adjectives_type",
ADD COLUMN "type" text   NOT NULL ,
ADD PRIMARY KEY ("type")

ALTER TABLE "public"."allergies" DROP CONSTRAINT "allergies_pkey",
DROP COLUMN "allergy_type",
ADD COLUMN "type" text   NOT NULL ,
ADD PRIMARY KEY ("type")

ALTER TABLE "public"."cuisines" DROP CONSTRAINT "cuisines_pkey",
DROP COLUMN "cuisine_type",
ADD COLUMN "type" text   NOT NULL ,
ADD PRIMARY KEY ("type")

ALTER TABLE "public"."diets" DROP CONSTRAINT "diets_pkey",
DROP COLUMN "diet_type",
ADD COLUMN "type" text   NOT NULL ,
ADD PRIMARY KEY ("type")

ALTER TABLE "public"."ingredients" DROP CONSTRAINT "ingredients_pkey",
DROP COLUMN "ingredient_name",
DROP COLUMN "price",
ADD COLUMN "name" text   NOT NULL ,
ADD COLUMN "price_currency" text   NOT NULL ,
ADD COLUMN "price_amount" Decimal(65,30)   NOT NULL ,
ADD PRIMARY KEY ("name")

ALTER TABLE "public"."recipe_adjectives" DROP COLUMN "adjectives_type",
ADD COLUMN "type" text   

ALTER TABLE "public"."recipe_allergies" DROP COLUMN "allergy_type",
ADD COLUMN "type" text   

ALTER TABLE "public"."recipe_cuisines" DROP COLUMN "cuisine_type",
ADD COLUMN "type" text   

ALTER TABLE "public"."recipe_diets" DROP COLUMN "diet_type",
ADD COLUMN "type" text   

ALTER TABLE "public"."recipe_ingredients" DROP COLUMN "ingredient_name",
ADD COLUMN "name" text   

ALTER TABLE "public"."recipes" DROP COLUMN "recipe_name",
ADD COLUMN "name" text   NOT NULL 

ALTER TABLE "public"."user_allergies" DROP COLUMN "allergy_type",
ADD COLUMN "type" text   

ALTER TABLE "public"."user_diets" DROP COLUMN "diet_type",
ADD COLUMN "type" text   

ALTER TABLE "public"."user_pantries" DROP COLUMN "ingredient_name",
ADD COLUMN "name" text   

ALTER TABLE "public"."recipe_adjectives" ADD FOREIGN KEY ("type")REFERENCES "public"."adjectives"("type") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."recipe_allergies" ADD FOREIGN KEY ("type")REFERENCES "public"."allergies"("type") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."recipe_cuisines" ADD FOREIGN KEY ("type")REFERENCES "public"."cuisines"("type") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."recipe_diets" ADD FOREIGN KEY ("type")REFERENCES "public"."diets"("type") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."recipe_ingredients" ADD FOREIGN KEY ("name")REFERENCES "public"."ingredients"("name") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."user_allergies" ADD FOREIGN KEY ("type")REFERENCES "public"."allergies"("type") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."user_diets" ADD FOREIGN KEY ("type")REFERENCES "public"."diets"("type") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."user_pantries" ADD FOREIGN KEY ("name")REFERENCES "public"."ingredients"("name") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201013144839-add-facebook-id-to-users..20201017005155-removed-type-alias-and-add-price-currency
--- datamodel.dml
+++ datamodel.dml
@@ -3,84 +3,85 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model adjectives {
-  adjectives_type   String              @id
+  type              String              @id
   recipe_adjectives recipe_adjectives[]
 }
 model allergies {
-  allergy_type     String             @id
+  type             String             @id
   recipe_allergies recipe_allergies[]
   user_allergies   user_allergies[]
 }
 model cuisines {
-  cuisine_type    String            @id
+  type            String            @id
   recipe_cuisines recipe_cuisines[]
 }
 model diets {
-  diet_type    String         @id
+  type         String         @id
   recipe_diets recipe_diets[]
   user_diets   user_diets[]
 }
 model ingredients {
-  ingredient_name    String               @id
-  price              Float
+  name               String               @id
+  price_currency     String
+  price_amount       Float
   recipe_ingredients recipe_ingredients[]
   user_pantries      user_pantries[]
 }
 model recipe_adjectives {
-  id              Int         @id @default(autoincrement())
-  recipe_id       Int?
-  adjectives_type String?
-  adjectives      adjectives? @relation(fields: [adjectives_type], references: [adjectives_type])
-  recipes         recipes?    @relation(fields: [recipe_id], references: [id])
+  id         Int         @id @default(autoincrement())
+  recipe_id  Int?
+  type       String?
+  adjectives adjectives? @relation(fields: [type], references: [type])
+  recipes    recipes?    @relation(fields: [recipe_id], references: [id])
 }
 model recipe_allergies {
-  id           Int        @id @default(autoincrement())
-  recipe_id    Int?
-  allergy_type String?
-  allergies    allergies? @relation(fields: [allergy_type], references: [allergy_type])
-  recipes      recipes?   @relation(fields: [recipe_id], references: [id])
+  id        Int        @id @default(autoincrement())
+  recipe_id Int?
+  type      String?
+  allergies allergies? @relation(fields: [type], references: [type])
+  recipes   recipes?   @relation(fields: [recipe_id], references: [id])
 }
 model recipe_cuisines {
-  id           Int       @id @default(autoincrement())
-  recipe_id    Int?
-  cuisine_type String?
-  cuisines     cuisines? @relation(fields: [cuisine_type], references: [cuisine_type])
-  recipes      recipes?  @relation(fields: [recipe_id], references: [id])
+  id        Int       @id @default(autoincrement())
+  recipe_id Int?
+  type      String?
+  cuisines  cuisines? @relation(fields: [type], references: [type])
+  recipes   recipes?  @relation(fields: [recipe_id], references: [id])
 }
 model recipe_diets {
   id        Int      @id @default(autoincrement())
   recipe_id Int?
-  diet_type String?
-  diets     diets?   @relation(fields: [diet_type], references: [diet_type])
+  type      String?
+  diets     diets?   @relation(fields: [type], references: [type])
   recipes   recipes? @relation(fields: [recipe_id], references: [id])
 }
 model recipe_ingredients {
-  id              Int          @id @default(autoincrement())
-  recipe_id       Int?
-  ingredient_name String?
-  quantity        Float
-  ingredients     ingredients? @relation(fields: [ingredient_name], references: [ingredient_name])
-  recipes         recipes?     @relation(fields: [recipe_id], references: [id])
+  id          Int          @id @default(autoincrement())
+  recipe_id   Int?
+  name        String?
+  quantity    Float
+  ingredients ingredients? @relation(fields: [name], references: [name])
+  recipes     recipes?     @relation(fields: [recipe_id], references: [id])
 }
 model recipes {
   id                 Int                  @id @default(autoincrement())
-  recipe_name        String
+  name               String
   link               String               @unique
   prep_time          String
   servings           Float
   num_saved          Float
@@ -92,29 +93,29 @@
   user_saved_recipes user_saved_recipes[]
 }
 model user_allergies {
-  id           Int        @id @default(autoincrement())
-  user_id      Int?
-  allergy_type String?
-  allergies    allergies? @relation(fields: [allergy_type], references: [allergy_type])
-  users        users?     @relation(fields: [user_id], references: [id])
+  id        Int        @id @default(autoincrement())
+  user_id   Int?
+  type      String?
+  allergies allergies? @relation(fields: [type], references: [type])
+  users     users?     @relation(fields: [user_id], references: [id])
 }
 model user_diets {
-  id        Int     @id @default(autoincrement())
-  user_id   Int?
-  diet_type String?
-  diets     diets?  @relation(fields: [diet_type], references: [diet_type])
-  users     users?  @relation(fields: [user_id], references: [id])
+  id      Int     @id @default(autoincrement())
+  user_id Int?
+  type    String?
+  diets   diets?  @relation(fields: [type], references: [type])
+  users   users?  @relation(fields: [user_id], references: [id])
 }
 model user_pantries {
-  id              Int          @id @default(autoincrement())
-  user_id         Int?
-  ingredient_name String?
-  ingredients     ingredients? @relation(fields: [ingredient_name], references: [ingredient_name])
-  users           users?       @relation(fields: [user_id], references: [id])
+  id          Int          @id @default(autoincrement())
+  user_id     Int?
+  name        String?
+  ingredients ingredients? @relation(fields: [name], references: [name])
+  users       users?       @relation(fields: [user_id], references: [id])
 }
 model user_saved_recipes {
   id        Int      @id @default(autoincrement())
```


