# Migration `20201028212230-init`

This migration has been generated by Jack Tan at 10/29/2020, 10:22:30 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."Cuisine" AS ENUM ('AMERICAN', 'ITALIAN', 'ASIAN', 'MEXICAN', 'SOUTHERN_AND_SOUL_FOOD', 'FRENCH', 'SOUTH_WESTERN', 'BARBEQUE', 'INDIAN', 'CHINESE', 'CAJUN_AND_CREOLE', 'MEDITERRANEAN', 'GREEK', 'ENGLISH', 'SPANISH', 'THAI', 'GERMAN', 'MOROCCAN', 'IRISH', 'JAPANESE', 'CUBAN', 'HAWAIIAN', 'SWEDISH', 'HUNGARIAN', 'PORTUGUESE')

CREATE TYPE "public"."Diet" AS ENUM ('KETOGENIC', 'VEGETARIAN_NO_MEAT_AND_EGGS', 'VEGETARIAN_NO_MEAT_AND_DAIRY', 'PESCATARIAN', 'VEGAN', 'LOW_FOODMAP', 'VEGETARIAN', 'PALEO')

CREATE TYPE "public"."Allergy" AS ENUM ('GLUTEN', 'PEANUT', 'SEAFOOD', 'SESAME', 'SOY', 'DIARY', 'EGG', 'SULPHITE', 'TREE_NUT', 'WHEAT')

CREATE TYPE "public"."Meal" AS ENUM ('BREAKFAST', 'LUNCH', 'DINNER')

CREATE TABLE "public"."ingredients" (
"name" text   NOT NULL ,
"price_currency" text   ,
"price_amount" Decimal(65,30)   ,
"usersId" integer   ,
PRIMARY KEY ("name")
)

CREATE TABLE "public"."recipe_ingredients" (
"recipe_link" text   NOT NULL ,
"ingredient_name" text   ,
"amount" Decimal(65,30)   ,
"measurement" text   ,
"recipe_text" text   NOT NULL ,
PRIMARY KEY ("recipe_link","recipe_text")
)

CREATE TABLE "public"."recipes" (
"id" SERIAL,
"name" text   NOT NULL ,
"link" text   NOT NULL ,
"prep_time" text   NOT NULL ,
"servings" Decimal(65,30)   NOT NULL ,
"num_saved" Decimal(65,30)   NOT NULL ,
"adjectives" text []  ,
"allergies" "Allergy"[]  ,
"cuisines" "Cuisine"[]  ,
"diets" "Diet"[]  ,
"meals" "Meal"[]  ,
"usersId" integer   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."users" (
"id" SERIAL,
"google_id" text   ,
"facebook_id" text   ,
"email" text   NOT NULL ,
"password" text   ,
"nickname" text   ,
"allergies" "Allergy"[]  ,
"diets" "Diet"[]  ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "recipes.link_unique" ON "public"."recipes"("link")

CREATE UNIQUE INDEX "users.google_id_unique" ON "public"."users"("google_id")

CREATE UNIQUE INDEX "users.facebook_id_unique" ON "public"."users"("facebook_id")

CREATE UNIQUE INDEX "users.email_unique" ON "public"."users"("email")

ALTER TABLE "public"."ingredients" ADD FOREIGN KEY ("usersId")REFERENCES "public"."users"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."recipe_ingredients" ADD FOREIGN KEY ("ingredient_name")REFERENCES "public"."ingredients"("name") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."recipe_ingredients" ADD FOREIGN KEY ("recipe_link")REFERENCES "public"."recipes"("link") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."recipes" ADD FOREIGN KEY ("usersId")REFERENCES "public"."users"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201028212230-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,117 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+enum Cuisine {
+  AMERICAN
+  ITALIAN
+  ASIAN
+  MEXICAN
+  SOUTHERN_AND_SOUL_FOOD
+  FRENCH
+  SOUTH_WESTERN
+  BARBEQUE
+  INDIAN
+  CHINESE
+  CAJUN_AND_CREOLE
+  MEDITERRANEAN
+  GREEK
+  ENGLISH
+  SPANISH
+  THAI
+  GERMAN
+  MOROCCAN
+  IRISH
+  JAPANESE
+  CUBAN
+  HAWAIIAN
+  SWEDISH
+  HUNGARIAN
+  PORTUGUESE
+}
+
+enum Diet {
+  KETOGENIC
+  VEGETARIAN_NO_MEAT_AND_EGGS
+  VEGETARIAN_NO_MEAT_AND_DAIRY
+  PESCATARIAN
+  VEGAN
+  LOW_FOODMAP
+  VEGETARIAN
+  PALEO
+}
+
+enum Allergy {
+  GLUTEN
+  PEANUT
+  SEAFOOD
+  SESAME
+  SOY
+  DIARY
+  EGG
+  SULPHITE
+  TREE_NUT
+  WHEAT
+}
+
+enum Meal {
+  BREAKFAST
+  LUNCH
+  DINNER
+}
+
+model ingredients {
+  name               String               @id
+  price_currency     String?
+  price_amount       Float?
+  recipe_ingredients recipe_ingredients[]
+  users              users?               @relation(fields: [usersId], references: [id])
+  usersId            Int?
+}
+
+model recipe_ingredients {
+  recipe_link     String
+  ingredient_name String?
+  amount          Float?
+  measurement     String?
+  recipe_text     String
+  ingredient      ingredients? @relation(fields: [ingredient_name], references: [name])
+  recipes         recipes      @relation(fields: [recipe_link], references: [link])
+
+  @@id([recipe_link, recipe_text])
+}
+
+model recipes {
+  id          Int                  @id @default(autoincrement())
+  name        String
+  link        String               @unique
+  prep_time   String
+  servings    Float
+  num_saved   Float
+  adjectives  String[]
+  allergies   Allergy[]
+  cuisines    Cuisine[]
+  diets       Diet[]
+  meals       Meal[]
+  ingredients recipe_ingredients[]
+  users       users?               @relation(fields: [usersId], references: [id])
+  usersId     Int?
+}
+
+model users {
+  id            Int           @id @default(autoincrement())
+  google_id     String?       @unique
+  facebook_id   String?       @unique
+  email         String        @unique
+  password      String?
+  nickname      String?
+  allergies     Allergy[]
+  diets         Diet[]
+  pantries      ingredients[]
+  saved_recipes recipes[]
+}
```


